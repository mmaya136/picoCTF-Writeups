# VNE â€“ picoCTF 2023 Writeup

<img width="886" height="575" alt="image" src="https://github.com/user-attachments/assets/001c50cd-cb74-490d-920a-8b2f3f5eeb04" />

---

## Challenge Description

The challenge provides us with:

- SSH access to `saturn.picoctf.net:60650`
- Credentials: `ctf-player` / `d8819d45`
- A binary named `bin` that can list directories as root
- Tags: bash, env, injection

---

## Solution

### Step 1: SSH Connection

First, I connected to the challenge instance:

```bash
ssh ctf-player@saturn.picoctf.net -p 60650
# Password: d8819d45
```

 ### Step 2: Initial Reconnaissance
After connecting, I explored the environment:

<img width="886" height="276" alt="image" src="https://github.com/user-attachments/assets/965c8a1a-afe0-425c-a75e-7113327f8063" />


 ### Step 3: Analyzing the Binary
Running the binary without setting the required environment variable:

<img width="886" height="224" alt="image" src="https://github.com/user-attachments/assets/e66815e3-e961-441c-95d1-1969e49f9ec7" />


ctf-player@pico-chall$ ./bin
Error:

Error: SECRET_DIR environment variable is not set/listing the content of as root: Is Error: system() call returned non-zero value: 0
The binary expects a SECRET_DIR environment variable and uses system() to execute a command.

 ###  Step 4: Testing Normal Functionality
I set the SECRET_DIR variable to /root to list its contents:

<img width="792" height="163" alt="image" src="https://github.com/user-attachments/assets/ae8203f7-1461-41c4-8b20-0ff6c28b4693" />


Listing the content of /root as root:

flag.txt

The binary has SUID permissions and runs ls on the specified directory as root. The flag is located at /root/flag.txt.

 ###  Step 5: Command Injection via Environment Variable
Since the binary uses system() with the environment variable value, I can inject additional commands using shell metacharacters:

system("ls " + SECRET_DIR);
With our payload, it becomes:

system("ls ; cat /root/flag.txt");

This executes ls (showing "bin" in current directory), then executes cat /root/flag.txt with root privileges.

<img width="886" height="145" alt="image" src="https://github.com/user-attachments/assets/16cad689-73b4-40de-8082-3e3d27fc27e2" />







# Flag
picoCTF{Power_t0_man!pul4t3_3nv_cdeb2a4d}
